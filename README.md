# SourceMod Plugins for Insurgency

* [Insurgency Logger](plugins/ins_logger.smx?raw=true): Creates hooks and events for Insurgency-specific stat logging. Fixes a lot of issues with missing log entries for HLStatsX, this plugin is tightly bound with my HLStatsX fork I created to handle more Insurgency-specific data and events. This is based off of Brutus' Insurgency logger, but adds support for nearly every event supported by the game, enhances support for new weapons by removing the old config file method of adding weapons, and generally kicks ass if you're looking to create stats from Insurgency. This is generally stable, I look at it as a beta release candidate right now.
* [Compass](plugins/compass.smx?raw=true): Adds a check_compass command that clients can use and get their ordinal direction where they are looking in relation to where they stand. Like a compass. Release ready, no known bugs.
* [Bot Count](plugins/botcount.smx?raw=true): Displays a popup to players every 60 seconds by default identifying remaining enemy players alive. Beginning of a "UAV" feature, my goal is to create an entity on the map that can be used to get this information rather than just spamming it. Release ready, no known bugs.
* [Ammo check](plugins/ammocheck.smx?raw=true): Adds check_ammo command that client runs and gets RO2-style "Mag feels mostly full" estimation of remaining ammo. Reloading will also pop this up to alert player if they have inserted a magazine that is less than full. Future features I'd like to do are to show a reload animation partially to animate the check, and have the check command delay the next weapon attack to simulate removing and checking the magazine. Due to the way the theater system works, it's not practical to hard-code weapon data like magazine capacity in the plugin as similar CS and TF2 plugins do, so I have a hacky method that checks the 'm_iClip' variable and uses that to perform the math. There are other workarounds and todos in the source code as well. Release candidate, no obvious bugs, but still needs a lot of polish.
* [Suicide Bombs](plugins/suicide_bomb.smx?raw=true): Adds a suicide bomb effect that creates an IED at the player's origin and immediately detonates. Release 1 has all 'bomber' class players detonate on death, which is very annoying in game but is a proof of concept. I am trying to add bot targeting and behavior to make them seek players or at least blow themselves up when they run into a group of players. Currently seems bug-free, but is new and needs more testing before I feel comfortable calling this a beta.
* [Restricted Area Removal](plugins/restrictedarea.smx?raw=true): Removes all restricted areas on the map. Release ready, no known bugs.
* [Fog remover](plugins/nofog.smx?raw=true): Removes all fog on the map. Release ready, no known bugs.
* [Chat improvements](plugins/navmesh-chat.smx?raw=true): Adds prefix to all chat messages (selectable team or all) that includes grid coordinates, area name (if named in navmesh). For radio commands, it adds those and also a distance and direction related to the player. Plans are to make all messages include distance, direction, grid, and area in a standard way, add support for radio commands with a target other than the players current location, replacing the existing spot feature with a callout using this format, and in-game icons for a wider array of tasks than the move/grenade ones we have now. This plugin is currently complex in that it relies on parsing the map overview data from the Data repository existing in the Insurgency game root directory, cloned to insurgency-data. This has a lot of work to do, especially in getting the overview data from the engine directly rather than hacking around it. This is still very much under active development and could blow up your server, but I'd appreciate testing and feedback.
* [HLStatsX](plugins/hlstatsx.smx?raw=true): Adds in-game support for HLStatsX servers to connect and send messages and other tasks. Adds color support, and a number of other features absent from the HLStatsX upstream version. Release ready, no known bugs.
* [Coop Lobby Size](plugins/cooplobby.smx?raw=true): Increases max for mp_cooplobbysize from 8 to 16. Requires custom theaters to allow all 16 players to select a class. Release ready, no known bugs.

### Ideas to develop
This is a sort of scratchpad and todo list for things that I think of or people ask for me to work on.
* [ ] Use navmesh to find hiding spots, rather than spawn all bots in one wave, in midair; have them appear at a hiding place instead of the usual wave method. The spot would be checked to be far enough away from players to keep a 360 degree theat area, and keep them far enough away that we dont start spawning bots in the middle of fireteams. Navmesh is already parsed, just need to figure out how to find the location of the team, determine fudge factors (like difficulty, number of players, and distance between players), and loop hiding spots to do the spawn. 
* [ ] Remove counterattack capture ability in checkpoint coop mode via a cvar. Having to capture a building and then stand inside it while it gets assaulted instead of choosing good firing positions outside makes the game switch from tight, careful action to Call of Duty twitch shooter.
* [ ] Review bot CVARs and changes from last two patches to see if there are any new options to try or setting changes that can help get the bots to behave like mildly well trained, scared teenagers instead of a guy on a sunday stroll who can hipshoot you at a hundred meters.
* [ ] IR strobe on the back of US helmets for IFF. Possible to do with a particle effect or alpha/color mask, Source engine precompiled lighting makes actual strobes unlikely.
* [ ] IR laser? Is there a variable I can check to see if a player has NV enabled, and then how to control visibility of the beam per-client.
* [ ] Artillery, mortar, or air support SM plugin to give delayed but devastating damage on an area? How to balance and offset the massive power for the Insurgent side?
* [ ] Wounded/disabled players, can talk for very short time but no ability to move or shoot? Implement contact shots?
* [ ] Look at ability to modify game rules via tricky Sourcemod magic, like passing off spawning additional waves, spawning in staggered groups, and other fun things we need to do.
* [ ] Ability to loot ammo from dead bodies and have them added to the player's inventory properly. Needs to be sorted out how player inventory is handled, with the array method where each magazine's capacity is tracked and retained, and make sure we only pick up the right ammo for the primary weapon. The system needs to inform player "picked up one full AK74 magazine" or "picked up one nearly empty M16 magazine". Should loot from most full to least full, loot one mag per run of the command, and say how many mags still available to be looted. Add cvar-controlled timer to delay next loot/shoot/reload/switch for half a second or so to balance it. Add support for shared magazines, namely AKS74U/AK74 and M16/M4A1/MK18.
* [ ] Decouple flashbang visual impairment and audio impairment. The goal is to slightly increase flashed vision loss time, but greatly increase efefct and duration of audio impairment.
* [ ] Add backblast to AT4.
